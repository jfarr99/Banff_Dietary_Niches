diet_matrix <- t(otu_table(bis_elk)) # get our community matrix
covar_table <- data.frame(sample_data(bis_elk))
bis_elk_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
pairwise.species <- read.csv("Outputs/pairwise_comparisons_across_all_species_dec082024.csv")
pairwise.species <- read.csv("Outputs/pairwise_comparisons_across_all_species_dec082024.csv")
pairwise.species
pairwise.species <- read.csv("Outputs/pairwise_comparisons_across_all_species_dec082024.csv") %>%
filter(!grepl("goat|moose"), species)
pairwise.species <- read.csv("Outputs/pairwise_comparisons_across_all_species_dec082024.csv") %>%
filter(!grepl("goat|moose", species))
pairwise.species
### trying our mantel tests
diss_mat <- df %>%
pivot_wider(names_from = species, values_from = rsq) %>%
column_to_rownames("species")
### trying our mantel tests
diss_mat <- pairwise.species %>%
pivot_wider(names_from = species, values_from = rsq) %>%
column_to_rownames("species")
pairwise.species
str(pairwise.species)
### trying our mantel tests
diss_mat <- pairwise.species %>%
pivot_wider(names_from = species, values_from = rsq)
diss_mat
?pivot_wider
### trying our mantel tests
diss_mat <- pairwise.species %>% dplyr::select(species, rsq) %>%
pivot_wider(names_from = species, values_from = rsq)
diss_mat
# bison sheep
bis_bhs <- subset_samples(physeq_rra, Species == "Bison" | Species == "BighornSheep")
diet_matrix <- t(otu_table(bis_bhs)) # get our community matrix
covar_table <- data.frame(sample_data(bis_bhs))
bis_bhs_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
# bison elk
bis_elk <- subset_samples(physeq_rra, Species == "Bison" | (Species == "Elk" & Long < -115.4105))
diet_matrix <- t(otu_table(bis_elk)) # get our community matrix
covar_table <- data.frame(sample_data(bis_elk))
bis_elk_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
# bison deer
bis_deer  <- subset_samples(physeq_rra, Species == "Bison" | Species == "Deer")
diet_matrix <- t(otu_table(bis_deer)) # get our community matrix
covar_table <- data.frame(sample_data(bis_deer))
bis_deer_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
bis_deer_pair
# bighorn slk
dat  <- subset_samples(physeq_rra, Species == "BighornSheep" | Species == "Elk")
diet_matrix <- t(otu_table(dat)) # get our community matrix
covar_table <- data.frame(sample_data(dat))
bhs_elk_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
bhs_elk_pair
# bighorn deer
dat  <- subset_samples(physeq_rra, Species == "BighornSheep" | Species == "Deer")
diet_matrix <- t(otu_table(dat)) # get our community matrix
covar_table <- data.frame(sample_data(dat))
bhs_deer_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
bhs_deer_pair
# elk - deer
dat  <- subset_samples(physeq_rra, Species == "Elk" | Species == "Deer")
diet_matrix <- t(otu_table(dat)) # get our community matrix
covar_table <- data.frame(sample_data(dat))
elk_deer_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
elk_deer_pair
?as.matrix
# Split species names
pairwise.species_split <- tidyr::separate(pairwise.species, species, into=c("sp1","sp2"), sep="-")
pairwise.species_split
# Split species names
pairwise.species_split <- tidyr::separate(pairwise.species, species, into=c("sp1","sp2"), sep="_")
pairwise.species_split
pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>% pivot_wider(names_from = c(sp1, sp2), values_from = rsq)
pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>% pivot_wider(names_from = c(sp1), values_from = rsq)
pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>% pivot_wider(names_from = c(sp2), values_from = rsq)
pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>% pivot_wider(names_from = c(sp1), values_from = rsq) %>% as.matrix()
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>% pivot_wider(names_from = c(sp1), values_from = rsq) %>% as.matrix()
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
dis_mat
pairwise.species_split
size_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, body_diff) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
size_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, body_diff) %>%
pivot_wider(names_from = c(sp1), values_from = body_diff) %>%
column_to_rownames("sp2") %>% as.matrix()
size_mat
diss_dist <- as.dist(diss_mat)
size_dist <- as.dist(size_mat)
diss_dist
size_dist
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
size_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, body_diff) %>%
pivot_wider(names_from = c(sp1), values_from = body_diff) %>%
column_to_rownames("sp2") %>% as.matrix()
diss_dist <- as.dist(diss_mat)
size_dist <- as.dist(size_mat)
diss_mat
# Split species names
pairwise.species_split <- tidyr::separate(pairwise.species, species, into=c("sp1","sp2"), sep="_")
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
dis_mat
size_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, body_diff) %>%
pivot_wider(names_from = c(sp1), values_from = body_diff) %>%
column_to_rownames("sp2") %>% as.matrix()
diss_dist <- as.dist(diss_mat)
size_dist <- as.dist(size_mat)
diss_dist
size_dist
size_mat
diss_mat
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
diss_dist <- as.dist(dis_mat)
size_dist <- as.dist(size_mat)
diss_dist
dis_mat
?as.dist
diss_dist <- as.dist(dis_mat, upper = TRUE)
diss_dist
diss_dist <- as.dist(dis_mat, diag = TRUE)
diss_dist
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
size_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, body_diff) %>%
pivot_wider(names_from = c(sp1), values_from = body_diff) %>%
column_to_rownames("sp2") %>% as.matrix()
# Force symmetry
dis_mat <- dis_mat + t(dis_mat)
size_mat <- size_mat + t(size_mat)
diag(diss_mat) <- 0
diag(size_mat) <- 0
diss_mat
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
size_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, body_diff) %>%
pivot_wider(names_from = c(sp1), values_from = body_diff) %>%
column_to_rownames("sp2") %>% as.matrix()
# Force symmetry
dis_mat <- dis_mat + t(dis_mat)
size_mat <- size_mat + t(size_mat)
diag(dis_mat) <- 0
diag(size_mat) <- 0
dis_mat
size_mat
dis_mat
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
size_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, body_diff) %>%
pivot_wider(names_from = c(sp1), values_from = body_diff) %>%
column_to_rownames("sp2") %>% as.matrix()
# Force symmetry
dis_mat <- dis_mat + t(dis_mat)
dis_mat
t(dis_mat)
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
dis_mat
pairwise.species_split
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq)
dis_mat
pairwise.species_split
pairwise.species_split <- rbind(pairwise.species_split, data.frame(X = 7:10, sp1 = c("bis", "bhs", "elk", "deer"),sp2= c("bis", "bhs", "elk", "deer"),
rsq = NA, pseudoF = NA, pval = NA, body_diff  = NA, comparison = NA, holm = NA))
pairwise.species_split
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
size_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, body_diff) %>%
pivot_wider(names_from = c(sp1), values_from = body_diff) %>%
column_to_rownames("sp2") %>% as.matrix()
dis_mat
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2")
dis_mat
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
size_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, body_diff) %>%
pivot_wider(names_from = c(sp1), values_from = body_diff) %>%
column_to_rownames("sp2") %>% as.matrix()
# Force symmetry
dis_mat <- dis_mat + t(dis_mat)
size_mat <- size_mat + t(size_mat)
size_mat
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
arrange(sp1)
pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
arrange(sp1)
dis_mat <- pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
arrange(sp1) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2") %>% as.matrix()
dis_mat
pairwise.species <- read.csv("Outputs/pairwise_comparisons_across_all_species_dec082024.csv") %>%
filter(!grepl("goat|moose", species))
# Split species names
pairwise.species_split <- tidyr::separate(pairwise.species, species, into=c("sp1","sp2"), sep="_")
pairwise.species_split
pairwise.species_split <- rbind(pairwise.species_split, data.frame(X = 7:10, sp1 = c("bis", "bhs", "elk", "deer"),sp2= c("bis", "bhs", "elk", "deer"),
rsq = NA, pseudoF = NA, pval = NA, body_diff  = NA, comparison = NA, holm = NA))
pairwise.species_split
pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
arrange(sp1)
pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
arrange(sp1) %>%
pivot_wider(names_from = c(sp1), values_from = rsq)
pairwise.species_split %>% dplyr::select(sp1, sp2, rsq) %>%
arrange(sp1) %>%
pivot_wider(names_from = c(sp1), values_from = rsq) %>%
column_to_rownames("sp2")
# Make square matrix of species × species
species <- unique(c(pairwise.species_split$sp1, pairwise.species_split$sp2))
species
rsq_mat <- matrix(NA, nrow=length(species), ncol=length(species),
dimnames=list(species, species))
rsq_mat
# Fill matrix
for(i in 1:nrow(pairwise.species_split)) {
rsq_mat[pairwise.species_split$sp1[i], pairwise.species_split$sp2[i]] <- pairwise.species_split$rsq[i]
rsq_mat[pairwise.species_split$sp2[i], pairwise.species_split$sp1[i]] <- pairwise.species_split$rsq[i]  # make symmetric
}
diag(rsq_mat) <- 0
rsq_mat
pairwise.species_split
size_mat <- matrix(NA, nrow=length(species), ncol=length(species),
dimnames=list(species, species))
# Fill matrix
for(i in 1:nrow(pairwise.species_split)) {
rsq_mat[pairwise.species_split$sp1[i], pairwise.species_split$sp2[i]] <- pairwise.species_split$body_diff[i]
rsq_mat[pairwise.species_split$sp2[i], pairwise.species_split$sp1[i]] <- pairwise.species_split$body_diff[i]  # make symmetric
}
# Make square matrix of species × species
species <- unique(c(pairwise.species_split$sp1, pairwise.species_split$sp2))
rsq_mat <- matrix(NA, nrow=length(species), ncol=length(species),
dimnames=list(species, species))
size_mat <- matrix(NA, nrow=length(species), ncol=length(species),
dimnames=list(species, species))
# Fill matrix
for(i in 1:nrow(pairwise.species_split)) {
rsq_mat[pairwise.species_split$sp1[i], pairwise.species_split$sp2[i]] <- pairwise.species_split$rsq[i]
rsq_mat[pairwise.species_split$sp2[i], pairwise.species_split$sp1[i]] <- pairwise.species_split$rsq[i]  # make symmetric
}
diag(rsq_mat) <- 0
# Fill matrix
for(i in 1:nrow(pairwise.species_split)) {
size_mat[pairwise.species_split$sp1[i], pairwise.species_split$sp2[i]] <- pairwise.species_split$body_diff[i]
size_mat[pairwise.species_split$sp2[i], pairwise.species_split$sp1[i]] <- pairwise.species_split$body_diff[i]  # make symmetric
}
diag(size_mat) <- 0
size_mat
diss_dist <- as.dist(rsq_mat)
diss_dist
size_dist <- as.dist(size_mat)
# mantel test!
mantel_res <- mantel(diss_dist, size_dist, method = "pearson", permutations = 999)
print(mantel_res)
?multipatt
mantel_res
print(mantel_res)
summary(mantel_res)
pairwise.species
# get our adjusted p values
pairwise.species <- data.frame(species = c("bis_bhs", "bis_elk", "bis_deer",
"bhs_elk", "bhs_deer",
"elk_deer"),
rsq = c(bis_bhs_pair$R2[1],
bis_elk_pair$R2[1],
bis_deer_pair$R2[1],
#
bhs_elk_pair$R2[1],
bhs_deer_pair$R2[1],
#
elk_deer_pair$R2[1]),
#
pseudoF = c(bis_bhs_pair$F[1],
bis_elk_pair$F[1],
bis_deer_pair$F[1],
#
bhs_elk_pair$F[1],
bhs_deer_pair$F[1],
#
elk_deer_pair$F[1],
elk_moose_pair$F[1]),
pval = c(bis_bhs_pair$`Pr(>F)`[1],
bis_elk_pair$`Pr(>F)`[1],
bis_deer_pair$`Pr(>F)`[1],
#
bhs_elk_pair$`Pr(>F)`[1],
bhs_deer_pair$`Pr(>F)`[1],
#
elk_deer_pair$`Pr(>F)`[1],
elk_moose_pair$`Pr(>F)`[1]),
body_diff = c(550, 375, 545, 175, 5, 170))
# get our adjusted p values
pairwise.species <- data.frame(species = c("bis_bhs", "bis_elk", "bis_deer",
"bhs_elk", "bhs_deer",
"elk_deer"),
rsq = c(bis_bhs_pair$R2[1],
bis_elk_pair$R2[1],
bis_deer_pair$R2[1],
#
bhs_elk_pair$R2[1],
bhs_deer_pair$R2[1],
#
elk_deer_pair$R2[1]),
#
pseudoF = c(bis_bhs_pair$F[1],
bis_elk_pair$F[1],
bis_deer_pair$F[1],
#
bhs_elk_pair$F[1],
bhs_deer_pair$F[1],
#
elk_deer_pair$F[1]),
pval = c(bis_bhs_pair$`Pr(>F)`[1],
bis_elk_pair$`Pr(>F)`[1],
bis_deer_pair$`Pr(>F)`[1],
#
bhs_elk_pair$`Pr(>F)`[1],
bhs_deer_pair$`Pr(>F)`[1],
#
elk_deer_pair$`Pr(>F)`[1],
elk_moose_pair$`Pr(>F)`[1]),
body_diff = c(550, 375, 545, 175, 5, 170))
# get our adjusted p values
pairwise.species <- data.frame(species = c("bis_bhs", "bis_elk", "bis_deer",
"bhs_elk", "bhs_deer",
"elk_deer"),
rsq = c(bis_bhs_pair$R2[1],
bis_elk_pair$R2[1],
bis_deer_pair$R2[1],
#
bhs_elk_pair$R2[1],
bhs_deer_pair$R2[1],
#
elk_deer_pair$R2[1]),
#
pseudoF = c(bis_bhs_pair$F[1],
bis_elk_pair$F[1],
bis_deer_pair$F[1],
#
bhs_elk_pair$F[1],
bhs_deer_pair$F[1],
#
elk_deer_pair$F[1]),
pval = c(bis_bhs_pair$`Pr(>F)`[1],
bis_elk_pair$`Pr(>F)`[1],
bis_deer_pair$`Pr(>F)`[1],
#
bhs_elk_pair$`Pr(>F)`[1],
bhs_deer_pair$`Pr(>F)`[1],
#
elk_deer_pair$`Pr(>F)`[1]),
body_diff = c(550, 375, 545, 175, 5, 170))
pairwise.species$holm <-   p.adjust(pairwise.species$pval, "holm")
pairwise.species
write.csv(pairwise.species, "Outputs/pairwise_comparisons_across_all_species_dec082024.csv")
pairwise.species <- read.csv("Outputs/pairwise_comparisons_across_all_species_dec082024.csv")
# Split species names
pairwise.species_split <- tidyr::separate(pairwise.species, species, into=c("sp1","sp2"), sep="_")
pairwise.species_split <- rbind(pairwise.species_split, data.frame(X = 7:10, sp1 = c("bis", "bhs", "elk", "deer"),sp2= c("bis", "bhs", "elk", "deer"),
rsq = NA, pseudoF = NA, pval = NA, body_diff  = NA, comparison = NA, holm = NA))
# Make square matrix of species × species
species <- unique(c(pairwise.species_split$sp1, pairwise.species_split$sp2))
pairwise.species <- read.csv("Outputs/pairwise_comparisons_across_all_species_dec082024.csv")
# Split species names
pairwise.species_split <- tidyr::separate(pairwise.species, species, into=c("sp1","sp2"), sep="_")
pairwise.species_split <- rbind(pairwise.species_split, data.frame(X = 7:10, sp1 = c("bis", "bhs", "elk", "deer"),sp2= c("bis", "bhs", "elk", "deer"),
rsq = NA, pseudoF = NA, pval = NA, body_diff  = NA,holm = NA))
# Make square matrix of species × species
species <- unique(c(pairwise.species_split$sp1, pairwise.species_split$sp2))
rsq_mat <- matrix(NA, nrow=length(species), ncol=length(species),
dimnames=list(species, species))
size_mat <- matrix(NA, nrow=length(species), ncol=length(species),
dimnames=list(species, species))
# Fill matrix
for(i in 1:nrow(pairwise.species_split)) {
rsq_mat[pairwise.species_split$sp1[i], pairwise.species_split$sp2[i]] <- pairwise.species_split$rsq[i]
rsq_mat[pairwise.species_split$sp2[i], pairwise.species_split$sp1[i]] <- pairwise.species_split$rsq[i]  # make symmetric
}
diag(rsq_mat) <- 0
# Fill matrix
for(i in 1:nrow(pairwise.species_split)) {
size_mat[pairwise.species_split$sp1[i], pairwise.species_split$sp2[i]] <- pairwise.species_split$body_diff[i]
size_mat[pairwise.species_split$sp2[i], pairwise.species_split$sp1[i]] <- pairwise.species_split$body_diff[i]  # make symmetric
}
diag(size_mat) <- 0
# converting to distance objects!
diss_dist <- as.dist(rsq_mat)
size_dist <- as.dist(size_mat)
# mantel test!
mantel_res <- mantel(diss_dist, size_dist, method = "pearson", permutations = 999)
print(mantel_res)
sample_data(physeq_rra)$feeding_mode <- if_else(sample_data(physeq_rra)$Species == "Bison" |
sample_data(physeq_rra)$Species == "BighornSheep", "Grazer",
if_else(sample_data(physeq_rra)$Species== "Deer", "Browser", "Mixed"))
feeding_mode_dat <- subset_samples(physeq_rra, (Species != "Moose" & Species != "Goat"))
# group species by functional feeding more and see if permanova differentiates them... use spicy pairwise comparisons too!!
diet_matrix <- t(otu_table(feeding_mode_dat)) # get our community matrix
covar_table <- data.frame(sample_data(feeding_mode_dat))
# run adonis test... community data matrix ~ covariate (rows in community matrix match rows in covar data frame)
table(covar_table$feeding_mode)
ffmode_mod <- adonis2(diet_matrix ~ feeding_mode, data = covar_table, permutations = 999,
method = "bray",
parallel = 15, na.action = na.fail)
ffmode_mod
# group species by functional feeding more and see if permanova differentiates them... use spicy pairwise comparisons too!!
graz_browse <- subset_samples(physeq_rra, (feeding_mode == "Grazer" # filter for bison, elk, sheep
| feeding_mode == "Browser"))
diet_matrix <- t(otu_table(graz_browse)) # get our community matrix
# group species by functional feeding more and see if permanova differentiates them... use spicy pairwise comparisons too!!
graz_browse <- subset_samples(feeding_mode_dat, (feeding_mode == "Grazer" # filter for bison, elk, sheep
| feeding_mode == "Browser"))
diet_matrix <- t(otu_table(graz_browse)) # get our community matrix
covar_table <- data.frame(sample_data(graz_browse))
# run adonis test... community data matrix ~ covariate (rows in community matrix match rows in covar data frame)
table(covar_table$feeding_mode)
ffmode_mod <- adonis2(diet_matrix ~ feeding_mode, data = covar_table, permutations = 999,
method = "bray",
parallel = 15, na.action = na.fail)
ffmode_mod
## graz graz!
graz_browse <- subset_samples(feeding_mode_dat, (feeding_mode == "Grazer" # filter for bison, elk, sheep
| feeding_mode == "Mixed"))
diet_matrix <- t(otu_table(graz_browse)) # get our community matrix
covar_table <- data.frame(sample_data(graz_browse))
# run adonis test... community data matrix ~ covariate (rows in community matrix match rows in covar data frame)
table(covar_table$feeding_mode)
ffmode_mod <- adonis2(diet_matrix ~ feeding_mode, data = covar_table, permutations = 999,
method = "bray",
parallel = 15, na.action = na.fail)
ffmode_mod
graz_browse <- subset_samples(feeding_mode_dat, (feeding_mode == "Browser" # filter for bison, elk, sheep
| feeding_mode == "Mixed"))
diet_matrix <- t(otu_table(graz_browse)) # get our community matrix
covar_table <- data.frame(sample_data(graz_browse))
# run adonis test... community data matrix ~ covariate (rows in community matrix match rows in covar data frame)
table(covar_table$feeding_mode)
ffmode_mod <- adonis2(diet_matrix ~ feeding_mode, data = covar_table, permutations = 999,
method = "bray",
parallel = 15, na.action = na.fail)
ffmode_mod
p.adjust(ffmode_mod$`Pr(>F)`, "holm", n = 3)
diet_matrix <- t(otu_table(physeq_rra_core)) # get our community matrix
covar_table <- data.frame(sample_data(physeq_rra_core))
class(covar_table)
# run adonis test... community data matrix ~ covariate (rows in community matrix match rows in covar data frame)
season_mod <- adonis2(diet_matrix ~ Species*Season, data = covar_table, permutations = 999,
method = "bray",
parallel = 15, na.action = na.fail)
# elk and bison spring
bis_elk <- subset_samples(physeq_rra_core,Zone == "In" &  Season == "Spring" & (Species == "Bison" | Species == "Elk"))
diet_matrix <- t(otu_table(bis_elk)) # get our community matrix
covar_table <- data.frame(sample_data(bis_elk))
bis_elk_sp_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
bis_elk_sp_pair
# elk and bison spring
bis_elk <- subset_samples(physeq_rra_core,Season == "Spring" & (Species == "Bison" | Species == "Elk"))
diet_matrix <- t(otu_table(bis_elk)) # get our community matrix
covar_table <- data.frame(sample_data(bis_elk))
bis_elk_sp_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
bis_elk_sp_pair
# elk and bison summer
bis_elk <- subset_samples(physeq_rra_core, Season == "Summer" & (Species == "Bison" | Species == "Elk"))
diet_matrix <- t(otu_table(bis_elk)) # get our community matrix
covar_table <- data.frame(sample_data(bis_elk))
bis_elk_su_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
bis_elk_su_pair
# bhs and bison winter
bis_bhs <- subset_samples(physeq_rra_core, Season == "Winter" & (Species == "Bison" | Species == "BighornSheep"))
diet_matrix <- t(otu_table(bis_bhs)) # get our community matrix
covar_table <- data.frame(sample_data(bis_bhs))
bis_bhs_w_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
bis_bhs_w_pair
# bhs and bison spring
bis_bhs <- subset_samples(physeq_rra_core, Season == "Spring" & (Species == "Bison" | Species == "BighornSheep"))
diet_matrix <- t(otu_table(bis_bhs)) # get our community matrix
covar_table <- data.frame(sample_data(bis_bhs))
bis_bhs_sp_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
bis_bhs_sp_pair
# bhs and bison SUMMER
bis_bhs <- subset_samples(physeq_rra_core, Season == "Summer" & (Species == "Bison" | Species == "BighornSheep"))
diet_matrix <- t(otu_table(bis_bhs)) # get our community matrix
covar_table <- data.frame(sample_data(bis_bhs))
bis_bhs_su_pair <- adonis2(diet_matrix ~ Species, data = covar_table, permutations = 999,
method = "bray", parallel = 15, na.action = na.fail)
bis_bhs_su_pair
